(function(t){function n(t){return function(){var n=new this.Chain;return n.init(t,arguments)}}function i(t){return function(){return this.addFunctionToQueue(t,arguments)}}t.ChainValidator={},t.ChainValidator.Chain=function(){this.Validator=new t.Validator,this.tokenQueue=[],this.Lexer=new t.Lexer},t.ChainValidator.Chain.prototype.validate=function(t){var n=this.Validator.validate({result:[t,this.tokenQueue]});return n.result},t.ChainValidator.Chain.prototype.init=function(t,n){return n=Array.prototype.slice.call(n,0),this.addToken([this.Lexer.TOKEN_TYPE_IDENTIFIER,t+":"+n.join(",")]),this},t.ChainValidator.Chain.prototype.addToken=function(t){this.tokenQueue.push(t)},t.ChainValidator.Chain.prototype.addTokens=function(t){this.tokenQueue=this.tokenQueue.concat(t)},t.ChainValidator.Chain.prototype.getTokens=function(){return this.tokenQueue},t.ChainValidator.Chain.prototype.or=function(t){return this.addToken([this.Lexer.TOKEN_TYPE_OPERATOR,1]),this.addToken([this.Lexer.TOKEN_TYPE_SUB_OPEN]),this.addTokens(t.getTokens()),this.addToken([this.Lexer.TOKEN_TYPE_SUB_CLOSE]),this},t.ChainValidator.Chain.prototype.and=function(t){return this.addToken([this.Lexer.TOKEN_TYPE_OPERATOR,2]),this.addToken([this.Lexer.TOKEN_TYPE_SUB_OPEN]),this.addTokens(t.getTokens()),this.addToken([this.Lexer.TOKEN_TYPE_SUB_CLOSE]),this},t.ChainValidator.Chain.prototype.not=function(t,n){return n||this.addToken([this.Lexer.TOKEN_TYPE_OPERATOR,2]),this.addToken([this.Lexer.TOKEN_TYPE_NEGATION]),this.addToken([this.Lexer.TOKEN_TYPE_SUB_OPEN]),this.addTokens(t.getTokens()),this.addToken([this.Lexer.TOKEN_TYPE_SUB_CLOSE]),this},t.ChainValidator.Chain.prototype.addFunctionToQueue=function(t,n){return n=Array.prototype.slice.call(n,0),this.addToken([this.Lexer.TOKEN_TYPE_OPERATOR,2]),this.addToken([this.Lexer.TOKEN_TYPE_IDENTIFIER,t+":"+n.join(",")]),this},t.ChainValidator.Validator=new t.Validator({});var o=t.ChainValidator.Validator.getFunctions();for(var e in o)o[e],t.ChainValidator[e]=n(e),t.ChainValidator.Chain.prototype[e]=i(e);t.ChainValidator.addFunction=function(t,n){this.Validator.addFunction(t,n),this[e]=getChainValidatorFunction(t,this),this.Chain.prototype[e]=getChainFunction(e)},t.ChainValidator.not=function(t){var n=new this.Chain;return n.not(t,!0)}})(window.Pupil);