(function(t){t.FormValidator=function(i){if(this.options={validationAttribute:"data-validation",highlightErrors:!0},i)for(var o in i)this.options[o]=i[o];this.Validator=new t.Validator},t.FormValidator.prototype.findChildNodes=function(t,i){var o=[],n=t.children;"object"!=typeof i&&(i=[i]);for(var e=0;n.length>e;e++){for(var r=n[e],a=!1,s=0;i.length>s;s++)("*"==i[s]||r.tagName.toLowerCase()==i[s].toLowerCase())&&(a=!0);a&&o.push(r),r.children.length>0&&(o=o.concat(this.findChildNodes(r,i)))}return o},t.FormValidator.prototype.validate=function(t,i){var o={};if(o=i!==void 0&&null!==i?this.validateByRules(t,i):this.validateByAttributes(t),this.options.highlightErrors){var n=this.findChildNodes(t,["input","textarea"]);this.highlightErrors(n,o)}return o},t.FormValidator.prototype.validateSingle=function(t,i){var o={},n={};return n[t.name]=i!==void 0&&null!==i?[t.value,i]:[t.value,t.getAttribute(this.options.validationAttribute)],o=this.Validator.validate(n),this.options.highlightErrors&&this.highlightErrors([t],o),o[t.name]},t.FormValidator.prototype.highlightErrors=function(t,i){for(var o=0;t.length>o;o++){var n=t[o].name;void 0!==i[n]&&(i[n]===!0?this.removeElementHighlight(t[o]):this.addElementHighlight(t[o]))}},t.FormValidator.prototype.addElementHighlight=function(t){var i=" "+t.className+" ";-1===i.indexOf("pupil-invalid")&&(i+=" pupil-invalid"),t.className=i.trim()},t.FormValidator.prototype.removeElementHighlight=function(t){var i=" "+t.className+" ";-1!==i.indexOf("pupil-invalid")&&(i=i.replace(" pupil-invalid "," ")),t.className=i.trim()},t.FormValidator.prototype.validateByRules=function(t,i){for(var o={},n=this.findChildNodes(t,["input","textarea"]),e=0;n.length>e;e++){var r=n[e].name;void 0!==i[r]&&(o[r]=[n[e].value,i[r]])}return this.Validator.validate(o)},t.FormValidator.prototype.validateByAttributes=function(t){for(var i=this.findChildNodes(t,["input","textarea"]),o={},n=0,e=0;i.length>e;e++){var r=i[e].name,a=i[e].value,s=i[e].getAttribute(this.options.validationAttribute);r&&null!==a&&s&&(o[r]=[a,s],n++)}return n>0?this.Validator.validate(o):{}}})(window.Pupil);